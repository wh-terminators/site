<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Terminator Deals — Hot Deals</title>
<link rel="stylesheet" href="css/styles.css">
<style>
body {
  background:#0b0d10; color:#fff; font-family:Inter,Arial,sans-serif;
  margin:0; padding:0; display:flex; flex-direction:column; align-items:center;
}
header {width:100%; max-width:1200px; padding:1rem;}
h1 {margin:0; font-size:1.4rem;}
#grid {
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
  gap:20px;
  width:100%;
  max-width:1200px;
  padding:1rem;
}
.card {
  background:#14171c; border-radius:14px; overflow:hidden;
  box-shadow:0 6px 16px rgba(0,0,0,0.25);
  opacity:0; transform:translateY(16px) scale(0.98);
  transition:opacity .38s ease, transform .38s ease, box-shadow .24s ease;
}
.card.is-visible {opacity:1; transform:translateY(0) scale(1);}
.card:hover {box-shadow:0 14px 40px rgba(0,0,0,0.4); transform:translateY(-4px) scale(1.01);}
.card .thumb {height:200px; overflow:hidden;}
.card img {width:100%; height:100%; object-fit:cover; transition:transform .4s ease;}
.card:hover img {transform:scale(1.06);}
.card .info {padding:1rem;}
.card h2 {font-size:1rem; margin:0 0 .4rem;}
.card p {margin:0 0 .6rem; color:#ccc; font-size:.9rem;}
.price {display:flex; gap:.6rem; align-items:baseline;}
.price_now {color:#00ff90; font-weight:600;}
.price_old {color:#777; text-decoration:line-through;}
.btns {display:flex; gap:.5rem; margin-top:.8rem;}
.btn {
  flex:1; border:none; border-radius:8px; padding:.6rem 0;
  cursor:pointer; font-weight:600; color:#fff; font-size:.9rem;
}
.whatsapp {background:#00a884;}
.compare {background:#1d72f2;}
.errorBox {color:#f55; margin:1rem;}
</style>
</head>

<body>
<header>
  <h1>Terminator Deals — Hot Deals</h1>
  <div id="error" class="errorBox hidden"></div>
</header>

<section id="grid"></section>

<script>
/* ===== CONFIG ===== */
const SHEET_ID = "1KzTz3QsWVZeVuxtE7Jw0uAqMBvvdQHT_Wuuv1zeWZk";
const SHEET_NAME = "Catalog";
const GID = "0";
const WHATSAPP = "13653784497";

/* ===== HELPERS ===== */
function money(n){return '$'+Number(n).toLocaleString();}
function slug(t){return String(t).toLowerCase().replace(/[^a-z0-9]+/g,'-');}
function parseCSV(text){
  const lines=text.split(/\r?\n/).filter(x=>x.trim().length);
  const head=lines.shift().split(',').map(x=>x.trim());
  return lines.map(l=>{
    const vals=l.split(',').map(x=>x.trim());
    return Object.fromEntries(head.map((h,i)=>[h,vals[i]]));
  });
}

/* ===== LOAD DATA ===== */
async function loadData(){
  try{
    const url=`https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv&sheet=${SHEET_NAME}`;
    const res=await fetch(url);
    if(!res.ok) throw new Error('HTTP '+res.status);
    const text=await res.text();
    const data=parseCSV(text);
    render(data.filter(i=>i.in_stock?.toLowerCase()==='yes'));
  }catch(e){
    document.getElementById('error').textContent='Failed to load Google Sheet. Details: '+e.message;
  }
}

/* ===== RENDER ===== */
function render(list){
  const grid=document.getElementById('grid');
  grid.innerHTML=list.map(item=>`
    <article class="card">
      <div class="thumb"><img src="${item.image}" alt="${item.title}"></div>
      <div class="info">
        <h2>${item.title}</h2>
        <p>${item.details||''}</p>
        <div class="price">
          <span class="price_now">${money(item.price_now)}</span>
          <span class="price_old">${money(item.price_old)}</span>
        </div>
        <div class="btns">
          <button class="btn whatsapp" onclick="window.open('https://wa.me/${WHATSAPP}?text=Hi! I\'m interested in ${encodeURIComponent(item.title)}','_blank')">WhatsApp</button>
          ${item.amazon_url?`<button class="btn compare" onclick="window.open('${item.amazon_url}','_blank')">Compare price</button>`:''}
        </div>
      </div>
    </article>
  `).join('');

  // animation wave
  const cards=Array.from(document.querySelectorAll('.card'));
  cards.forEach((el,i)=>{
    el.style.transitionDelay=`${i*80}ms`;
    requestAnimationFrame(()=>el.classList.add('is-visible'));
  });
}

loadData();
</script>
</body>
</html>
