<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Terminator Deals ‚Äî Catalog</title>
  <meta name="description" content="Live Facebook Marketplace catalog with direct WhatsApp contact."/>
  <style>
    body {margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial;background:#0f1115;color:#eef2ff}
    .wrap{max-width:1100px;margin:30px auto;padding:0 16px}
    header{display:flex;align-items:center;gap:12px;flex-wrap:wrap}
    .logo{width:42px;height:42px;border-radius:12px;background:linear-gradient(135deg,#10b981,#22c55e);display:grid;place-items:center;font-weight:800;color:#001510}
    h1{font-size:26px;margin:0}
    .sub{color:#8b93a7;font-size:14px;margin-top:4px}
    .search{margin-top:10px}
    .search input{
      width:100%;
      max-width:420px;
      padding:12px 14px;
      border-radius:12px;
      border:1px solid #23283a;
      background:#0c0f17;
      color:#eef2ff;
      outline:none;
    }
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:16px;margin-top:18px}
    .card{background:#151822;border-radius:18px;overflow:hidden;display:flex;flex-direction:column;box-shadow:0 6px 28px rgba(0,0,0,.25)}
    .thumb{position:relative;aspect-ratio:4/3;background:#111826}
    .thumb img{width:100%;height:100%;object-fit:cover}
    .body{padding:14px;display:flex;flex-direction:column;gap:6px}
    .title{font-size:16px;font-weight:700}
    .price{font-size:18px;color:#10b981;font-weight:800}
    .meta{color:#8b93a7;font-size:13px}
    .cta{padding:14px;margin-top:auto}
    .btn{display:block;text-align:center;padding:12px;border-radius:12px;background:linear-gradient(135deg,#10b981,#22c55e);color:#001510;font-weight:800;text-decoration:none}
    .chipbar{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .chip{border:1px solid #223;padding:8px 12px;border-radius:12px;background:#0c0f17;color:#8b93a7;cursor:pointer}
    .chip.active{background:#10b981;color:#001510;font-weight:700}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">WT</div>
      <div>
        <h1>Terminator Deals ‚Äî Hot Deals</h1>
        <div class="sub">Live sync with Facebook Marketplace. Click ‚ÄúMessage‚Äù to contact us on WhatsApp üî•</div>
      </div>
    </header>

    <div class="search">
      <input id="q" type="search" placeholder="Search by title‚Ä¶" />
    </div>

    <div id="catbar" class="chipbar"></div>
    <div id="grid" class="grid"></div>
  </div>

<script>
const WHATSAPP = "13653784497";
const API_URL = "https://api.apify.com/v2/datasets/KkctyzcZDf0TyIgXb/items?format=json&clean=true";

const grid = document.getElementById('grid');
const catbar = document.getElementById('catbar');
const q = document.getElementById('q');

function normalize(raw){
  const title = raw.marketplace_listing_title || raw.custom_title || "Untitled";
  const price = raw.listing_price?.amount || "";
  const city = raw.location?.city?.display_name || "";
  const img = raw.primary_listing_photo?.image?.uri || "";
  const url = raw.listing_url || "";
  const cat = raw.marketplace_listing_category_id || "Marketplace";
  return {title, price, city, img, url, cat};
}

function waLink(item){
  const msg = `Hi! I'm interested in "${item.title}" listed for $${item.price}. Location: ${item.city}. Link: ${item.url}`;
  return `https://api.whatsapp.com/send?phone=${WHATSAPP}&text=${encodeURIComponent(msg)}`;
}

function card(item){
  return `
  <article class="card">
    <div class="thumb"><img src="${item.img}" alt="${item.title}"/></div>
    <div class="body">
      <div class="title">${item.title}</div>
      <div class="price">${item.price ? `$${item.price}` : "Ask price"}</div>
      <div class="meta">${item.city}</div>
      <a href="${item.url}" target="_blank" class="meta">View on Facebook</a>
    </div>
    <div class="cta">
      <a class="btn" href="${waLink(item)}" target="_blank">Message on WhatsApp</a>
    </div>
  </article>`;
}

let items = [], activeCat = 'all';
function render(){
  const term = (q?.value || '').toLowerCase().trim();

  const byCat = i => activeCat==='all' ? true : i.cat === activeCat;
  const byTitle = i => !term ? true : i.title.toLowerCase().includes(term);

  const filtered = items.filter(byCat).filter(byTitle);
  grid.innerHTML = filtered.map(card).join('') || `<p>No items found.</p>`;
}

function renderCats(){
  const cats = ['all', ...new Set(items.map(i=>i.cat))];
  catbar.innerHTML = cats.map(c=>`<div class="chip${c===activeCat?' active':''}" data-cat="${c}">${c==='all'?'All':c}</div>`).join('');
  catbar.querySelectorAll('.chip').forEach(ch=>ch.onclick=()=>{activeCat=ch.dataset.cat;renderCats();render();});
}

(async()=>{
  const res = await fetch(API_URL);
  const data = await res.json();
  items = data.map(normalize);
  renderCats();
  render();
  q?.addEventListener('input', render);
})();
</script>
</body>
</html>
